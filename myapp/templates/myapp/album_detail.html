{% extends 'myapp/base.html' %}
{% load static %}

{% block content %}
  {% if error %}
    <div style="background: rgba(220, 38, 38, 0.1); border: 1px solid rgba(220, 38, 38, 0.3); border-radius: var(--radius-md); padding: 16px; color: #ef4444; margin-bottom: 24px;">
      Error: {{ error }}
    </div>
  {% endif %}

  {% if album %}
    <div class="album-header">
      {% if album.image %}
        <img src="{{ album.image }}" alt="{{ album.name }}" class="album-cover-large">
      {% endif %}
      <div class="album-info">
        <h1>{{ album.name }}</h1>
        <h2>{{ album.artist }}</h2>
        <div class="album-meta">
          {% if album.release_date %}
            <p style="margin: 0 0 8px 0;">Release date: {{ album.release_date }}</p>
          {% endif %}
          <p style="margin: 0;">Total tracks: {{ album.total_tracks }}</p>
        </div>
        <div class="album-actions" style="margin-top: 16px;">
          <a href="{% url 'myapp:rank' album_id=album.id %}" class="btn btn-primary">
            Start ranking
          </a>
          {% if user.is_authenticated %}
            <button id="save-album-btn" data-album-id="{{ album_id }}" class="btn btn-secondary">
              {% if saved %}âœ“ Saved{% else %}Save to My Music{% endif %}
            </button>
          {% else %}
            <a href="{% url 'myapp:login' %}?next={% url 'myapp:album_detail' album_id %}" class="btn btn-secondary">Save to My Music</a>
          {% endif %}
        </div>
      </div>
    </div>

    <div class="tracklist">
      <div class="tracklist-header">
        <div style="display: grid; grid-template-columns: 40px 1fr 80px; gap: 16px; padding: 0 16px;">
          <span>#</span>
          <span>Title</span>
          <span style="text-align: right;">Duration</span>
        </div>
      </div>
      {% for t in tracks %}
        <div class="track-row">
          <span class="rank" style="width: 40px; text-align: center;">{{ t.track_number }}</span>
          <div class="track-info">
            <div class="track-name">{{ t.name }}</div>
          </div>
          <span style="color: #666666; width: 80px; text-align: right;">{{ t.duration }}</span>
        </div>
      {% endfor %}
    </div>

  {% else %}
    <div class="empty-state">
      <p>Album not found.</p>
    </div>
  {% endif %}
  {% if user.is_authenticated %}
    <script src="{% static 'myapp/js/album_detail.js' %}"></script>
  {% endif %}
{% endblock %}
